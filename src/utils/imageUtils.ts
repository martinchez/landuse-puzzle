// Image pool for different land cover types
export const IMAGE_POOLS = {
  forest: [
    "https://images.pexels.com/photos/1179229/pexels-photo-1179229.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/957024/forest-trees-perspective-bright-957024.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/113338/pexels-photo-113338.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1834399/pexels-photo-1834399.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1563604/pexels-photo-1563604.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1008739/pexels-photo-1008739.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/572937/pexels-photo-572937.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1271620/pexels-photo-1271620.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/574190/pexels-photo-574190.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/2696134/pexels-photo-2696134.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop"
  ],
  water: [
    "https://images.pexels.com/photos/15568483/pexels-photo-15568483.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/2091351/pexels-photo-2091351.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/518485/pexels-photo-518485.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/2093805/pexels-photo-2093805.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/2649403/pexels-photo-2649403.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/2382941/pexels-photo-2382941.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/355808/pexels-photo-355808.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/13759/pexels-photo-13759.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/750854/pexels-photo-750854.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1315891/pexels-photo-1315891.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop"
  ],
  urban: [
    "https://images.pexels.com/photos/169647/pexels-photo-169647.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/466685/pexels-photo-466685.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1139556/pexels-photo-1139556.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/290595/pexels-photo-290595.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1105766/pexels-photo-1105766.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1168940/pexels-photo-1168940.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/378570/pexels-photo-378570.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/219692/pexels-photo-219692.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/773471/pexels-photo-773471.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1525612/pexels-photo-1525612.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop"
  ],
  farmland: [
    "https://images.pexels.com/photos/259280/pexels-photo-259280.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/974314/pexels-photo-974314.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1483880/pexels-photo-1483880.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/440731/pexels-photo-440731.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/753869/pexels-photo-753869.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/158827/field-corn-air-frisch-158827.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1227513/pexels-photo-1227513.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/265216/pexels-photo-265216.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1443867/pexels-photo-1443867.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/96715/pexels-photo-96715.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop"
  ],
  desert: [
    "https://images.pexels.com/photos/2245436/pexels-photo-2245436.png?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/4017971/pexels-photo-4017971.png?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/60013/desert-drought-dehydrated-clay-soil-60013.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1731660/pexels-photo-1731660.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/106606/pexels-photo-106606.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/847402/pexels-photo-847402.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1001435/pexels-photo-1001435.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/53537/caravan-desert-safari-dune-53537.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1824570/pexels-photo-1824570.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/2100387/pexels-photo-2100387.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop"
  ]
};

// Function to get a random image URL for a specific land cover type
export const getRandomImageUrl = (landCoverType: keyof typeof IMAGE_POOLS): string => {
  const pool = IMAGE_POOLS[landCoverType];
  if (!pool || pool.length === 0) {
    throw new Error(`No images available for land cover type: ${landCoverType}`);
  }
  const randomIndex = Math.floor(Math.random() * pool.length);
  return pool[randomIndex];
};

// Function to randomize all tiles in a level while preserving correct labels
export const randomizeLevelImages = (tiles: Array<{ id: string; correctLabel: keyof typeof IMAGE_POOLS }>) => {
  // Track used images for each label type to maximize variety
  const usedImagesByLabel: Record<keyof typeof IMAGE_POOLS, Set<string>> = {
    forest: new Set(),
    water: new Set(),
    urban: new Set(),
    farmland: new Set(),
    desert: new Set()
  };

  return tiles.map(tile => {
    const pool = IMAGE_POOLS[tile.correctLabel];
    if (!pool || pool.length === 0) {
      throw new Error(`No images available for land cover type: ${tile.correctLabel}`);
    }
    
    const usedImages = usedImagesByLabel[tile.correctLabel];
    let selectedImage: string;
    
    // If we haven't used all images in the pool, pick an unused one
    if (usedImages.size < pool.length) {
      const availableImages = pool.filter(img => !usedImages.has(img));
      const randomIndex = Math.floor(Math.random() * availableImages.length);
      selectedImage = availableImages[randomIndex];
    } else {
      // If all images have been used, reset and pick randomly
      usedImages.clear();
      const randomIndex = Math.floor(Math.random() * pool.length);
      selectedImage = pool[randomIndex];
    }
    
    usedImages.add(selectedImage);
    
    return {
      ...tile,
      imageUrl: selectedImage
    };
  });
};

// Function to generate a seeded random number for consistent randomization
export const seededRandom = (seed: number): number => {
  // Simple LCG (Linear Congruential Generator) for deterministic randomness
  const a = 1664525;
  const c = 1013904223;
  const m = Math.pow(2, 32);
  return ((a * seed + c) % m) / m;
};

// Function to get a seeded random image URL for consistent level generation
export const getSeededRandomImageUrl = (landCoverType: keyof typeof IMAGE_POOLS, seed: number): string => {
  const pool = IMAGE_POOLS[landCoverType];
  if (!pool || pool.length === 0) {
    throw new Error(`No images available for land cover type: ${landCoverType}`);
  }
  const randomValue = seededRandom(seed);
  const index = Math.floor(randomValue * pool.length);
  return pool[index];
};

// Function to randomize level images with a seed for consistency
export const randomizeLevelImagesWithSeed = (
  tiles: Array<{ id: string; correctLabel: keyof typeof IMAGE_POOLS }>, 
  levelId: number
) => {
  return tiles.map((tile, index) => {
    // Create a unique seed for each tile based on level ID and tile index
    const seed = levelId * 1000 + index;
    return {
      ...tile,
      imageUrl: getSeededRandomImageUrl(tile.correctLabel, seed)
    };
  });
};
