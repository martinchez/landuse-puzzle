// Image pool for different land cover types
export const IMAGE_POOLS = {
  forest: [
    "https://images.pexels.com/photos/957024/forest-trees-perspective-bright-957024.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/518803/pexels-photo-518803.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1671325/pexels-photo-1671325.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1578662/pexels-photo-1578662.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1910225/pexels-photo-1910225.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1179229/pexels-photo-1179229.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1108099/pexels-photo-1108099.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/326055/pexels-photo-326055.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/189349/pexels-photo-189349.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1423600/pexels-photo-1423600.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop"
  ],
  water: [
    "https://images.pexels.com/photos/1118873/pexels-photo-1118873.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1439061/pexels-photo-1439061.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1029604/pexels-photo-1029604.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1033729/pexels-photo-1033729.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/355321/pexels-photo-355321.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1770809/pexels-photo-1770809.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1457842/pexels-photo-1457842.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1591447/pexels-photo-1591447.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1422408/pexels-photo-1422408.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/752869/pexels-photo-752869.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop"
  ],
  urban: [
    "https://images.pexels.com/photos/466685/pexels-photo-466685.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1519088/pexels-photo-1519088.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/936722/pexels-photo-936722.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1534451/pexels-photo-1534451.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/830891/pexels-photo-830891.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1486222/pexels-photo-1486222.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1109541/pexels-photo-1109541.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1563356/pexels-photo-1563356.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/372098/pexels-photo-372098.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/206359/pexels-photo-206359.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop"
  ],
  farmland: [
    "https://images.pexels.com/photos/2132126/pexels-photo-2132126.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1595108/pexels-photo-1595108.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/2183508/pexels-photo-2183508.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1242348/pexels-photo-1242348.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/461838/pexels-photo-461838.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1595104/pexels-photo-1595104.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/325944/pexels-photo-325944.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1459339/pexels-photo-1459339.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/236691/pexels-photo-236691.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1402787/pexels-photo-1402787.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop"
  ],
  desert: [
    "https://images.pexels.com/photos/847402/pexels-photo-847402.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1028225/pexels-photo-1028225.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1906795/pexels-photo-1906795.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/6901/sky-desert-space-sand.jpg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/7919/pexels-photo.jpg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1166209/pexels-photo-1166209.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/816979/pexels-photo-816979.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1670187/pexels-photo-1670187.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/1268855/pexels-photo-1268855.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",
    "https://images.pexels.com/photos/547115/pexels-photo-547115.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop"
  ]
};

// Function to get a random image URL for a specific land cover type
export const getRandomImageUrl = (landCoverType: keyof typeof IMAGE_POOLS): string => {
  const pool = IMAGE_POOLS[landCoverType];
  if (!pool || pool.length === 0) {
    throw new Error(`No images available for land cover type: ${landCoverType}`);
  }
  const randomIndex = Math.floor(Math.random() * pool.length);
  return pool[randomIndex];
};

// Function to randomize all tiles in a level while preserving correct labels
export const randomizeLevelImages = (tiles: Array<{ id: string; correctLabel: keyof typeof IMAGE_POOLS }>) => {
  // Track used images for each label type to maximize variety
  const usedImagesByLabel: Record<keyof typeof IMAGE_POOLS, Set<string>> = {
    forest: new Set(),
    water: new Set(),
    urban: new Set(),
    farmland: new Set(),
    desert: new Set()
  };

  return tiles.map(tile => {
    const pool = IMAGE_POOLS[tile.correctLabel];
    if (!pool || pool.length === 0) {
      throw new Error(`No images available for land cover type: ${tile.correctLabel}`);
    }
    
    const usedImages = usedImagesByLabel[tile.correctLabel];
    let selectedImage: string;
    
    // If we haven't used all images in the pool, pick an unused one
    if (usedImages.size < pool.length) {
      const availableImages = pool.filter(img => !usedImages.has(img));
      const randomIndex = Math.floor(Math.random() * availableImages.length);
      selectedImage = availableImages[randomIndex];
    } else {
      // If all images have been used, reset and pick randomly
      usedImages.clear();
      const randomIndex = Math.floor(Math.random() * pool.length);
      selectedImage = pool[randomIndex];
    }
    
    usedImages.add(selectedImage);
    
    return {
      ...tile,
      imageUrl: selectedImage
    };
  });
};

// Function to generate a seeded random number for consistent randomization
export const seededRandom = (seed: number): number => {
  // Simple LCG (Linear Congruential Generator) for deterministic randomness
  const a = 1664525;
  const c = 1013904223;
  const m = Math.pow(2, 32);
  return ((a * seed + c) % m) / m;
};

// Function to get a seeded random image URL for consistent level generation
export const getSeededRandomImageUrl = (landCoverType: keyof typeof IMAGE_POOLS, seed: number): string => {
  const pool = IMAGE_POOLS[landCoverType];
  if (!pool || pool.length === 0) {
    throw new Error(`No images available for land cover type: ${landCoverType}`);
  }
  const randomValue = seededRandom(seed);
  const index = Math.floor(randomValue * pool.length);
  return pool[index];
};

// Function to randomize level images with a seed for consistency
export const randomizeLevelImagesWithSeed = (
  tiles: Array<{ id: string; correctLabel: keyof typeof IMAGE_POOLS }>, 
  levelId: number
) => {
  return tiles.map((tile, index) => {
    // Create a unique seed for each tile based on level ID and tile index
    const seed = levelId * 1000 + index;
    return {
      ...tile,
      imageUrl: getSeededRandomImageUrl(tile.correctLabel, seed)
    };
  });
};
